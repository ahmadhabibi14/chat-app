import{S as se,i as oe,s as ie,e as k,d as I,h as z,j as E,l as b,g as V,m as v,o as D,p,D as K,q as Q,L as ce,t as x,u as y,v as C,M as fe,z as ue,y as U,x as N,I as de,c as T,f as j,n as O,w as P,B,N as re,C as R,O as ne,E as q,H as J}from"./index.7qfkvOvh.js";import{e as Y}from"./each.-oqiv04n.js";import{I as A}from"./Icon.EjFrvX-M.js";import{t as W}from"./date_formatter.Zml5IhKd.js";const me={a:{viewBox:"0 0 24 24"},c:`<g><path fill="none" d="M0 0h24v24H0z"></path>
<path d="M3 13h6v-2H3V1.846a.5.5 0 0 1 .741-.438l18.462 10.154a.5.5 0 0 1 0 .876L3.741 22.592A.5.5 0 0 1 3 22.154V13z"></path></g>`},he={a:{viewBox:"0 0 24 24"},c:`<g><path fill="none" d="M0 0h24v24H0z"></path>
<path d="M12 22C6.477 22 2 17.523 2 12S6.477 2 12 2s10 4.477 10 10-4.477 10-10 10zm0-2a8 8 0 1 0 0-16 8 8 0 0 0 0 16zm1-8h4v2h-6V7h2v5z"></path></g>`},pe={a:{viewBox:"0 0 24 24"},c:`<g><path fill="none" d="M0 0h24v24H0z"></path>
<path d="M11.602 13.76l1.412 1.412 8.466-8.466 1.414 1.414-9.88 9.88-6.364-6.364 1.414-1.414 2.125 2.125 1.413 1.412zm.002-2.828l4.952-4.953 1.41 1.41-4.952 4.953-1.41-1.41zm-2.827 5.655L7.364 18 1 11.636l1.414-1.414 1.413 1.413-.001.001 4.951 4.951z"></path></g>`},_e={a:{viewBox:"0 0 24 24"},c:`<g><path fill="none" d="M0 0h24v24H0z"></path>
<path d="M12 22C6.477 22 2 17.523 2 12S6.477 2 12 2s10 4.477 10 10-4.477 10-10 10zm-1-7v2h2v-2h-2zm0-8v6h2V7h-2z"></path></g>`},ge={a:{viewBox:"0 0 24 24"},c:`<g><path fill="none" d="M0 0h24v24H0z"></path>
<path d="M12 2a1 1 0 0 1 1 1v3a1 1 0 0 1-2 0V3a1 1 0 0 1 1-1zm0 15a1 1 0 0 1 1 1v3a1 1 0 0 1-2 0v-3a1 1 0 0 1 1-1zm10-5a1 1 0 0 1-1 1h-3a1 1 0 0 1 0-2h3a1 1 0 0 1 1 1zM7 12a1 1 0 0 1-1 1H3a1 1 0 0 1 0-2h3a1 1 0 0 1 1 1zm12.071 7.071a1 1 0 0 1-1.414 0l-2.121-2.121a1 1 0 0 1 1.414-1.414l2.121 2.12a1 1 0 0 1 0 1.415zM8.464 8.464a1 1 0 0 1-1.414 0L4.93 6.344a1 1 0 0 1 1.414-1.415L8.464 7.05a1 1 0 0 1 0 1.414zM4.93 19.071a1 1 0 0 1 0-1.414l2.121-2.121a1 1 0 1 1 1.414 1.414l-2.12 2.121a1 1 0 0 1-1.415 0zM15.536 8.464a1 1 0 0 1 0-1.414l2.12-2.121a1 1 0 0 1 1.415 1.414L16.95 8.464a1 1 0 0 1-1.414 0z"></path></g>`};var H=(o=>(o.Load="load",o.Sent="sent",o.Error="error",o))(H||{});function Z(o,e,l){const t=o.slice();return t[11]=e[l],t[13]=l,t}function ee(o){let e,l,t=Y(o[1]),r=[];for(let s=0;s<t.length;s+=1)r[s]=te(Z(o,t,s));const c=s=>y(r[s],1,1,()=>{r[s]=null});return{c(){for(let s=0;s<r.length;s+=1)r[s].c();e=U()},l(s){for(let n=0;n<r.length;n+=1)r[n].l(s);e=U()},m(s,n){for(let a=0;a<r.length;a+=1)r[a]&&r[a].m(s,n);D(s,e,n),l=!0},p(s,n){if(n&7){t=Y(s[1]);let a;for(a=0;a<t.length;a+=1){const i=Z(s,t,a);r[a]?(r[a].p(i,n),x(r[a],1)):(r[a]=te(i),r[a].c(),x(r[a],1),r[a].m(e.parentNode,e))}for(N(),a=t.length;a<r.length;a+=1)c(a);C()}},i(s){if(!l){for(let n=0;n<t.length;n+=1)x(r[n]);l=!0}},o(s){r=r.filter(Boolean);for(let n=0;n<r.length;n+=1)y(r[n]);l=!1},d(s){s&&b(e),de(r,s)}}}function ve(o){let e,l,t,r,c=o[11].sender+"",s,n,a,i,_=o[11].content+"",$,u,m=W(o[11].datetime)+"",f,h;return{c(){e=k("div"),l=k("div"),t=k("span"),r=B("@"),s=B(c),n=I(),a=k("p"),i=new re(!1),$=I(),u=k("span"),f=B(m),h=I(),this.h()},l(d){e=z(d,"DIV",{class:!0,id:!0});var w=E(e);l=z(w,"DIV",{class:!0});var M=E(l);t=z(M,"SPAN",{class:!0});var g=E(t);r=R(g,"@"),s=R(g,c),g.forEach(b),n=V(M),a=z(M,"P",{class:!0});var L=E(a);i=ne(L,!1),L.forEach(b),$=V(M),u=z(M,"SPAN",{class:!0});var S=E(u);f=R(S,m),S.forEach(b),M.forEach(b),h=V(w),w.forEach(b),this.h()},h(){v(t,"class","text-[10px] text-sky-600 font-semibold w-fit"),i.a=null,v(a,"class","text-ellipsis break-all"),v(u,"class","text-start text-[10px] font-light text-zinc-700"),v(l,"class","w-fit max-w-[70%] rounded-e-md rounded-tl-md bg-zinc-100 p-2 gap-1 flex flex-col"),v(e,"class","flex w-full justify-start text-sm"),v(e,"id",`CH_${o[13]}`)},m(d,w){D(d,e,w),p(e,l),p(l,t),p(t,r),p(t,s),p(l,n),p(l,a),i.m(_,a),p(l,$),p(l,u),p(u,f),p(e,h)},p(d,w){w&2&&c!==(c=d[11].sender+"")&&q(s,c),w&2&&_!==(_=d[11].content+"")&&i.p(_),w&2&&m!==(m=W(d[11].datetime)+"")&&q(f,m)},i:J,o:J,d(d){d&&b(e)}}}function be(o){let e,l,t,r=o[11].content+"",c,s;return{c(){e=k("div"),l=k("div"),t=k("p"),c=B(r),s=I(),this.h()},l(n){e=z(n,"DIV",{class:!0,id:!0});var a=E(e);l=z(a,"DIV",{class:!0});var i=E(l);t=z(i,"P",{class:!0});var _=E(t);c=R(_,r),_.forEach(b),i.forEach(b),s=V(a),a.forEach(b),this.h()},h(){v(t,"class","text-ellipsis break-all text-[10px]"),v(l,"class","w-fit max-w-full mx-5 bg-emerald-500/20 text-emerald-700 border border-emerald-700 rounded-full font-semibold py-1 px-3 flex flex-row"),v(e,"class","flex w-full justify-center text-sm"),v(e,"id",`CH_${o[13]}`)},m(n,a){D(n,e,a),p(e,l),p(l,t),p(t,c),p(e,s)},p(n,a){a&2&&r!==(r=n[11].content+"")&&q(c,r)},i:J,o:J,d(n){n&&b(e)}}}function we(o){let e,l,t,r,c=o[11].content+"",s,n,a,i,_,$,u=W(o[11].datetime)+"",m,f,h;const d=[ze,ke,xe],w=[];function M(g,L){return g[2].state===H.Load&&g[2].index===g[13]?0:g[2].state===H.Error&&g[2].index===g[13]?1:2}return a=M(o),i=w[a]=d[a](o),{c(){e=k("div"),l=k("div"),t=k("p"),r=new re(!1),s=I(),n=k("div"),i.c(),_=I(),$=k("span"),m=B(u),f=I(),this.h()},l(g){e=z(g,"DIV",{class:!0,id:!0});var L=E(e);l=z(L,"DIV",{class:!0});var S=E(l);t=z(S,"P",{class:!0});var G=E(t);r=ne(G,!1),G.forEach(b),s=V(S),n=z(S,"DIV",{class:!0});var F=E(n);i.l(F),_=V(F),$=z(F,"SPAN",{});var X=E($);m=R(X,u),X.forEach(b),F.forEach(b),S.forEach(b),f=V(L),L.forEach(b),this.h()},h(){r.a=null,v(t,"class","text-ellipsis break-all"),v(n,"class","flex flex-row gap-1 justify-end items-center text-xs font-light text-emerald-100"),v(l,"class","w-fit max-w-[70%] rounded-tr-md rounded-s-md bg-emerald-700 text-white p-2 gap-1 flex flex-col"),v(e,"class","flex w-full justify-end text-sm"),v(e,"id",`CH_${o[13]}`)},m(g,L){D(g,e,L),p(e,l),p(l,t),r.m(c,t),p(l,s),p(l,n),w[a].m(n,null),p(n,_),p(n,$),p($,m),p(e,f),h=!0},p(g,L){(!h||L&2)&&c!==(c=g[11].content+"")&&r.p(c);let S=a;a=M(g),a!==S&&(N(),y(w[S],1,1,()=>{w[S]=null}),C(),i=w[a],i||(i=w[a]=d[a](g),i.c()),x(i,1),i.m(n,_)),(!h||L&2)&&u!==(u=W(g[11].datetime)+"")&&q(m,u)},i(g){h||(x(i),h=!0)},o(g){y(i),h=!1},d(g){g&&b(e),w[a].d()}}}function xe(o){let e,l;return e=new A({props:{size:"12",src:pe,className:"fill-emerald-200"}}),{c(){T(e.$$.fragment)},l(t){j(e.$$.fragment,t)},m(t,r){O(e,t,r),l=!0},i(t){l||(x(e.$$.fragment,t),l=!0)},o(t){y(e.$$.fragment,t),l=!1},d(t){P(e,t)}}}function ke(o){let e,l;return e=new A({props:{size:"12",src:_e,className:"fill-emerald-200"}}),{c(){T(e.$$.fragment)},l(t){j(e.$$.fragment,t)},m(t,r){O(e,t,r),l=!0},i(t){l||(x(e.$$.fragment,t),l=!0)},o(t){y(e.$$.fragment,t),l=!1},d(t){P(e,t)}}}function ze(o){let e,l;return e=new A({props:{size:"12",src:he,className:"fill-emerald-200"}}),{c(){T(e.$$.fragment)},l(t){j(e.$$.fragment,t)},m(t,r){O(e,t,r),l=!0},i(t){l||(x(e.$$.fragment,t),l=!0)},o(t){y(e.$$.fragment,t),l=!1},d(t){P(e,t)}}}function te(o){let e,l,t,r;const c=[we,be,ve],s=[];function n(a,i){return a[11].sender===a[0]?0:a[11].sender==="system"&&a[11].type!=="text"?1:2}return e=n(o),l=s[e]=c[e](o),{c(){l.c(),t=U()},l(a){l.l(a),t=U()},m(a,i){s[e].m(a,i),D(a,t,i),r=!0},p(a,i){let _=e;e=n(a),e===_?s[e].p(a,i):(N(),y(s[_],1,1,()=>{s[_]=null}),C(),l=s[e],l?l.p(a,i):(l=s[e]=c[e](a),l.c()),x(l,1),l.m(t.parentNode,t))},i(a){r||(x(l),r=!0)},o(a){y(l),r=!1},d(a){a&&b(t),s[e].d(a)}}}function le(o){let e,l;return e=new A({props:{size:"23",src:me,className:"fill-white"}}),{c(){T(e.$$.fragment)},l(t){j(e.$$.fragment,t)},m(t,r){O(e,t,r),l=!0},i(t){l||(x(e.$$.fragment,t),l=!0)},o(t){y(e.$$.fragment,t),l=!1},d(t){P(e,t)}}}function ae(o){let e,l;return e=new A({props:{size:"23",src:ge,className:"fill-white animate-spin"}}),{c(){T(e.$$.fragment)},l(t){j(e.$$.fragment,t)},m(t,r){O(e,t,r),l=!0},i(t){l||(x(e.$$.fragment,t),l=!0)},o(t){y(e.$$.fragment,t),l=!1},d(t){P(e,t)}}}function Ee(o){let e,l,t,r,c,s,n,a,i,_,$,u=o[1]&&o[1].length&&ee(o),m=!o[4]&&le(),f=o[4]&&ae();return{c(){e=k("div"),l=k("div"),u&&u.c(),t=I(),r=k("div"),c=k("textarea"),s=I(),n=k("button"),m&&m.c(),a=I(),f&&f.c(),this.h()},l(h){e=z(h,"DIV",{class:!0});var d=E(e);l=z(d,"DIV",{class:!0});var w=E(l);u&&u.l(w),w.forEach(b),t=V(d),r=z(d,"DIV",{class:!0});var M=E(r);c=z(M,"TEXTAREA",{class:!0,name:!0,id:!0,rows:!0,placeholder:!0}),E(c).forEach(b),s=V(M),n=z(M,"BUTTON",{class:!0});var g=E(n);m&&m.l(g),a=V(g),f&&f.l(g),g.forEach(b),M.forEach(b),d.forEach(b),this.h()},h(){v(l,"class","flex flex-col gap-2 min-h-full h-full w-full px-5 pt-5 pb-0 mb-20"),v(c,"class","scrollbar-hide resize-none grow rounded-md border border-zinc-200 p-2 w-full h-full caret-emerald-700 focus:border-emerald-700 focus:outline focus:outline-emerald-700 svelte-1rli4li"),v(c,"name","message"),v(c,"id","message"),v(c,"rows","10"),v(c,"placeholder","Message..."),n.disabled=o[4],v(n,"class","bg-emerald-700 disabled:bg-emerald-600 hover:bg-emerald-600 cursor-pointer text-white h-full py-auto px-3 rounded-md"),v(r,"class","-ml-[2px] w-[700px] p-3 fixed flex flex-row gap-3 items-end bottom-0 h-16 bg-white border-t-[2px] border-x-[2px] border-zinc-100"),v(e,"class","min-h-full h-full relative w-full")},m(h,d){D(h,e,d),p(e,l),u&&u.m(l,null),p(e,t),p(e,r),p(r,c),K(c,o[3]),p(r,s),p(r,n),m&&m.m(n,null),p(n,a),f&&f.m(n,null),i=!0,_||($=[Q(c,"input",o[6]),Q(n,"click",ce(o[5]))],_=!0)},p(h,[d]){h[1]&&h[1].length?u?(u.p(h,d),d&2&&x(u,1)):(u=ee(h),u.c(),x(u,1),u.m(l,null)):u&&(N(),y(u,1,1,()=>{u=null}),C()),d&8&&K(c,h[3]),h[4]?m&&(N(),y(m,1,1,()=>{m=null}),C()):m?d&16&&x(m,1):(m=le(),m.c(),x(m,1),m.m(n,a)),h[4]?f?d&16&&x(f,1):(f=ae(),f.c(),x(f,1),f.m(n,null)):f&&(N(),y(f,1,1,()=>{f=null}),C()),(!i||d&16)&&(n.disabled=h[4])},i(h){i||(x(u),x(m),x(f),i=!0)},o(h){y(u),y(m),y(f),i=!1},d(h){h&&b(e),u&&u.d(),m&&m.d(),f&&f.d(),_=!1,fe($)}}}function $e(o,e,l){let{username:t=""}=e,r=[],c=0,s={state:H.Load,index:c};const n=new URL(window.location.href);let a=`ws://${window.location.host}/api/room-general`;n.protocol.includes("s")&&(a=`wss://${window.location.host}/api/room-general`);let i=new WebSocket(a);ue(()=>localStorage.setItem("username",t)),i.onopen=()=>{console.log("Connected to the room chat")},i.onmessage=f=>{const d=JSON.parse(f.data);d.sender!==t&&(d.type==="text"&&(d.content=d.content.replace(/\r\n|\n|\r/gm,"<br />")),l(1,r=[...r,d]),setTimeout(()=>{document.getElementById(`CH_${c}`).scrollIntoView({behavior:"smooth"}),c+=1},300))},i.onclose=f=>{console.log("Closed:",f)},i.onerror=f=>{console.log("Error:",f)};let _="",$=!1;function u(){if(!_)return;l(4,$=!0);const f={type:"text",content:_},h={sender:t,type:"text",content:_.replace(/\r\n|\n|\r/gm,"<br />"),datetime:new Date};l(1,r=[...r,h]),l(2,s.state=H.Load,s),setTimeout(()=>{document.getElementById(`CH_${c}`).scrollIntoView({behavior:"smooth"}),c+=1},300);try{l(3,_=""),i.send(JSON.stringify(f)),l(2,s={state:H.Sent,index:c-1}),l(4,$=!1)}catch(d){console.log("ERROR sending message",d),l(2,s={state:H.Error,index:c-1}),l(4,$=!1)}}function m(){_=this.value,l(3,_)}return o.$$set=f=>{"username"in f&&l(0,t=f.username)},[t,r,s,_,$,u,m]}class Ie extends se{constructor(e){super(),oe(this,e,$e,Ee,ie,{username:0})}}export{Ie as default};
