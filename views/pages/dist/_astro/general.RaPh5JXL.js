import{S as he,i as me,s as pe,e as z,d as I,h as E,j as M,g as V,l as b,m as w,o as D,p as _,D as te,q as G,K as _e,t as $,u as S,v as N,L as de,z as ge,c as A,f as U,k as Q,n as F,H as J,w as W,y as K,x as B,I as Z,B as T,C as O,E as P}from"./index.G980_WQ4.js";import{e as j}from"./each.-oqiv04n.js";import{I as q}from"./Icon.eATlZtET.js";import{t as X}from"./date_formatter.Zml5IhKd.js";const ve={a:{viewBox:"0 0 24 24"},c:`<g><path fill="none" d="M0 0h24v24H0z"></path>
<path d="M3 13h6v-2H3V1.846a.5.5 0 0 1 .741-.438l18.462 10.154a.5.5 0 0 1 0 .876L3.741 22.592A.5.5 0 0 1 3 22.154V13z"></path></g>`},be={a:{viewBox:"0 0 24 24"},c:`<g><path fill="none" d="M0 0h24v24H0z"></path>
<path d="M12 22C6.477 22 2 17.523 2 12S6.477 2 12 2s10 4.477 10 10-4.477 10-10 10zm0-2a8 8 0 1 0 0-16 8 8 0 0 0 0 16zm1-8h4v2h-6V7h2v5z"></path></g>`},we={a:{viewBox:"0 0 24 24"},c:`<g><path fill="none" d="M0 0h24v24H0z"></path>
<path d="M11.602 13.76l1.412 1.412 8.466-8.466 1.414 1.414-9.88 9.88-6.364-6.364 1.414-1.414 2.125 2.125 1.413 1.412zm.002-2.828l4.952-4.953 1.41 1.41-4.952 4.953-1.41-1.41zm-2.827 5.655L7.364 18 1 11.636l1.414-1.414 1.413 1.413-.001.001 4.951 4.951z"></path></g>`},xe={a:{viewBox:"0 0 24 24"},c:`<g><path fill="none" d="M0 0h24v24H0z"></path>
<path d="M12 22C6.477 22 2 17.523 2 12S6.477 2 12 2s10 4.477 10 10-4.477 10-10 10zm-1-7v2h2v-2h-2zm0-8v6h2V7h-2z"></path></g>`},ke={a:{viewBox:"0 0 24 24"},c:`<g><path fill="none" d="M0 0h24v24H0z"></path>
<path d="M12 2a1 1 0 0 1 1 1v3a1 1 0 0 1-2 0V3a1 1 0 0 1 1-1zm0 15a1 1 0 0 1 1 1v3a1 1 0 0 1-2 0v-3a1 1 0 0 1 1-1zm10-5a1 1 0 0 1-1 1h-3a1 1 0 0 1 0-2h3a1 1 0 0 1 1 1zM7 12a1 1 0 0 1-1 1H3a1 1 0 0 1 0-2h3a1 1 0 0 1 1 1zm12.071 7.071a1 1 0 0 1-1.414 0l-2.121-2.121a1 1 0 0 1 1.414-1.414l2.121 2.12a1 1 0 0 1 0 1.415zM8.464 8.464a1 1 0 0 1-1.414 0L4.93 6.344a1 1 0 0 1 1.414-1.415L8.464 7.05a1 1 0 0 1 0 1.414zM4.93 19.071a1 1 0 0 1 0-1.414l2.121-2.121a1 1 0 1 1 1.414 1.414l-2.12 2.121a1 1 0 0 1-1.415 0zM15.536 8.464a1 1 0 0 1 0-1.414l2.12-2.121a1 1 0 0 1 1.415 1.414L16.95 8.464a1 1 0 0 1-1.414 0z"></path></g>`},ze={a:{viewBox:"0 0 24 24"},c:`<g><path fill="none" d="M0 0H24V24H0z"></path>
<path d="M2.808 1.393l17.677 17.678-1.414 1.414-3.683-3.682L12 21 .69 6.997c.914-.74 1.902-1.391 2.95-1.942L1.394 2.808l1.415-1.415zm.771 5.999L12 17.817l1.967-2.437-8.835-8.836c-.532.254-1.05.536-1.552.848zM12 3c4.284 0 8.22 1.497 11.31 3.996l-5.407 6.693-1.422-1.422 3.939-4.876C17.922 5.841 15.027 5 12 5c-.873 0-1.735.07-2.58.207L7.725 3.51C9.094 3.177 10.527 3 12 3z"></path></g>`};var R=(i=>(i.Load="load",i.Sent="sent",i.Error="error",i))(R||{});function le(i,e,l){const t=i.slice();return t[14]=e[l],t[16]=l,t}function ne(i,e,l){const t=i.slice();return t[17]=e[l],t}function re(i,e,l){const t=i.slice();return t[17]=e[l],t}function se(i){let e,l,t,n,a,s,u='<h4 class="text-xl font-bold">Offline</h4> <p>Your network is not available. Check your data or wifi connection.</p>',r,m,v,L="Retry",C,p,g="Feedback",o,h,d;return t=new q({props:{size:"70",src:ze,className:"fill-purple-500"}}),{c(){e=z("div"),l=z("div"),A(t.$$.fragment),n=I(),a=z("div"),s=z("div"),s.innerHTML=u,r=I(),m=z("div"),v=z("button"),v.textContent=L,C=I(),p=z("button"),p.textContent=g,this.h()},l(c){e=E(c,"DIV",{class:!0});var f=M(e);l=E(f,"DIV",{class:!0});var x=M(l);U(t.$$.fragment,x),n=V(x),a=E(x,"DIV",{class:!0});var k=M(a);s=E(k,"DIV",{class:!0,"data-svelte-h":!0}),Q(s)!=="svelte-sksd7n"&&(s.innerHTML=u),r=V(k),m=E(k,"DIV",{class:!0});var y=M(m);v=E(y,"BUTTON",{class:!0,"data-svelte-h":!0}),Q(v)!=="svelte-150myb2"&&(v.textContent=L),C=V(y),p=E(y,"BUTTON",{class:!0,"data-svelte-h":!0}),Q(p)!=="svelte-1nft795"&&(p.textContent=g),y.forEach(b),k.forEach(b),x.forEach(b),f.forEach(b),this.h()},h(){w(s,"class","flex flex-col gap-1"),w(v,"class","w-fit h-fit py-1 px-3 rounded-full hover:bg-purple-500/10"),w(p,"class","w-fit h-fit py-1 px-3 rounded-full hover:bg-purple-500/10"),w(m,"class","flex w-full justify-end items-center gap-3 text-purple-500 font-semibold"),w(a,"class","grow flex flex-col gap-2"),w(l,"class","flex w-full flex-row gap-6 bg-zinc-100 p-3 rounded-md"),w(e,"class","flex w-full")},m(c,f){D(c,e,f),_(e,l),F(t,l,null),_(l,n),_(l,a),_(a,s),_(a,r),_(a,m),_(m,v),_(m,C),_(m,p),o=!0,h||(d=[G(v,"click",i[7]),G(p,"click",i[8])],h=!0)},p:J,i(c){o||($(t.$$.fragment,c),o=!0)},o(c){S(t.$$.fragment,c),o=!1},d(c){c&&b(e),W(t),h=!1,de(d)}}}function ae(i){let e,l,t=j(i[1]),n=[];for(let s=0;s<t.length;s+=1)n[s]=ce(le(i,t,s));const a=s=>S(n[s],1,1,()=>{n[s]=null});return{c(){for(let s=0;s<n.length;s+=1)n[s].c();e=K()},l(s){for(let u=0;u<n.length;u+=1)n[u].l(s);e=K()},m(s,u){for(let r=0;r<n.length;r+=1)n[r]&&n[r].m(s,u);D(s,e,u),l=!0},p(s,u){if(u&7){t=j(s[1]);let r;for(r=0;r<t.length;r+=1){const m=le(s,t,r);n[r]?(n[r].p(m,u),$(n[r],1)):(n[r]=ce(m),n[r].c(),$(n[r],1),n[r].m(e.parentNode,e))}for(B(),r=t.length;r<n.length;r+=1)a(r);N()}},i(s){if(!l){for(let u=0;u<t.length;u+=1)$(n[u]);l=!0}},o(s){n=n.filter(Boolean);for(let u=0;u<n.length;u+=1)S(n[u]);l=!1},d(s){s&&b(e),Z(n,s)}}}function Ee(i){let e,l,t,n,a=i[14].sender+"",s,u,r,m,v,L=X(i[14].datetime)+"",C,p,g=j(i[14].content),o=[];for(let h=0;h<g.length;h+=1)o[h]=oe(ne(i,g,h));return{c(){e=z("div"),l=z("div"),t=z("span"),n=T("@"),s=T(a),u=I(),r=z("p");for(let h=0;h<o.length;h+=1)o[h].c();m=I(),v=z("span"),C=T(L),p=I(),this.h()},l(h){e=E(h,"DIV",{class:!0,id:!0});var d=M(e);l=E(d,"DIV",{class:!0});var c=M(l);t=E(c,"SPAN",{class:!0});var f=M(t);n=O(f,"@"),s=O(f,a),f.forEach(b),u=V(c),r=E(c,"P",{class:!0});var x=M(r);for(let y=0;y<o.length;y+=1)o[y].l(x);x.forEach(b),m=V(c),v=E(c,"SPAN",{class:!0});var k=M(v);C=O(k,L),k.forEach(b),c.forEach(b),p=V(d),d.forEach(b),this.h()},h(){w(t,"class","text-[10px] text-sky-600 font-semibold w-fit"),w(r,"class","text-ellipsis break-all"),w(v,"class","text-start text-[10px] font-light text-zinc-700"),w(l,"class","w-fit max-w-[70%] rounded-e-md rounded-tl-md bg-zinc-100 p-2 gap-1 flex flex-col"),w(e,"class","flex w-full justify-start text-sm"),w(e,"id",`CH_${i[16]}`)},m(h,d){D(h,e,d),_(e,l),_(l,t),_(t,n),_(t,s),_(l,u),_(l,r);for(let c=0;c<o.length;c+=1)o[c]&&o[c].m(r,null);_(l,m),_(l,v),_(v,C),_(e,p)},p(h,d){if(d&2&&a!==(a=h[14].sender+"")&&P(s,a),d&2){g=j(h[14].content);let c;for(c=0;c<g.length;c+=1){const f=ne(h,g,c);o[c]?o[c].p(f,d):(o[c]=oe(f),o[c].c(),o[c].m(r,null))}for(;c<o.length;c+=1)o[c].d(1);o.length=g.length}d&2&&L!==(L=X(h[14].datetime)+"")&&P(C,L)},i:J,o:J,d(h){h&&b(e),Z(o,h)}}}function Le(i){let e,l,t,n=i[14].content+"",a,s;return{c(){e=z("div"),l=z("div"),t=z("p"),a=T(n),s=I(),this.h()},l(u){e=E(u,"DIV",{class:!0,id:!0});var r=M(e);l=E(r,"DIV",{class:!0});var m=M(l);t=E(m,"P",{class:!0});var v=M(t);a=O(v,n),v.forEach(b),m.forEach(b),s=V(r),r.forEach(b),this.h()},h(){w(t,"class","text-ellipsis break-all text-[10px]"),w(l,"class","w-fit max-w-full mx-5 bg-emerald-500/20 text-emerald-700 border border-emerald-700 rounded-full font-semibold py-1 px-3 flex flex-row"),w(e,"class","flex w-full justify-center text-sm"),w(e,"id",`CH_${i[16]}`)},m(u,r){D(u,e,r),_(e,l),_(l,t),_(t,a),_(e,s)},p(u,r){r&2&&n!==(n=u[14].content+"")&&P(a,n)},i:J,o:J,d(u){u&&b(e)}}}function $e(i){let e,l,t,n,a,s,u,r,m,v=X(i[14].datetime)+"",L,C,p,g=j(i[14].content),o=[];for(let f=0;f<g.length;f+=1)o[f]=ie(re(i,g,f));const h=[Ce,Me,ye],d=[];function c(f,x){return f[2].state===R.Load&&f[2].index===f[16]?0:f[2].state===R.Error&&f[2].index===f[16]?1:2}return s=c(i),u=d[s]=h[s](i),{c(){e=z("div"),l=z("div"),t=z("p");for(let f=0;f<o.length;f+=1)o[f].c();n=I(),a=z("div"),u.c(),r=I(),m=z("span"),L=T(v),C=I(),this.h()},l(f){e=E(f,"DIV",{class:!0,id:!0});var x=M(e);l=E(x,"DIV",{class:!0});var k=M(l);t=E(k,"P",{class:!0});var y=M(t);for(let Y=0;Y<o.length;Y+=1)o[Y].l(y);y.forEach(b),n=V(k),a=E(k,"DIV",{class:!0});var H=M(a);u.l(H),r=V(H),m=E(H,"SPAN",{});var ee=M(m);L=O(ee,v),ee.forEach(b),H.forEach(b),k.forEach(b),C=V(x),x.forEach(b),this.h()},h(){w(t,"class","text-ellipsis break-all"),w(a,"class","flex flex-row gap-1 justify-end items-center text-xs font-light text-emerald-100"),w(l,"class","w-fit max-w-[70%] rounded-tr-md rounded-s-md bg-emerald-700 text-white p-2 gap-1 flex flex-col"),w(e,"class","flex w-full justify-end text-sm"),w(e,"id",`CH_${i[16]}`)},m(f,x){D(f,e,x),_(e,l),_(l,t);for(let k=0;k<o.length;k+=1)o[k]&&o[k].m(t,null);_(l,n),_(l,a),d[s].m(a,null),_(a,r),_(a,m),_(m,L),_(e,C),p=!0},p(f,x){if(x&2){g=j(f[14].content);let y;for(y=0;y<g.length;y+=1){const H=re(f,g,y);o[y]?o[y].p(H,x):(o[y]=ie(H),o[y].c(),o[y].m(t,null))}for(;y<o.length;y+=1)o[y].d(1);o.length=g.length}let k=s;s=c(f),s!==k&&(B(),S(d[k],1,1,()=>{d[k]=null}),N(),u=d[s],u||(u=d[s]=h[s](f),u.c()),$(u,1),u.m(a,r)),(!p||x&2)&&v!==(v=X(f[14].datetime)+"")&&P(L,v)},i(f){p||($(u),p=!0)},o(f){S(u),p=!1},d(f){f&&b(e),Z(o,f),d[s].d()}}}function oe(i){let e,l=i[17]+"",t;return{c(){e=z("p"),t=T(l)},l(n){e=E(n,"P",{});var a=M(e);t=O(a,l),a.forEach(b)},m(n,a){D(n,e,a),_(e,t)},p(n,a){a&2&&l!==(l=n[17]+"")&&P(t,l)},d(n){n&&b(e)}}}function ie(i){let e,l=i[17]+"",t;return{c(){e=z("p"),t=T(l)},l(n){e=E(n,"P",{});var a=M(e);t=O(a,l),a.forEach(b)},m(n,a){D(n,e,a),_(e,t)},p(n,a){a&2&&l!==(l=n[17]+"")&&P(t,l)},d(n){n&&b(e)}}}function ye(i){let e,l;return e=new q({props:{size:"12",src:we,className:"fill-emerald-200"}}),{c(){A(e.$$.fragment)},l(t){U(e.$$.fragment,t)},m(t,n){F(e,t,n),l=!0},i(t){l||($(e.$$.fragment,t),l=!0)},o(t){S(e.$$.fragment,t),l=!1},d(t){W(e,t)}}}function Me(i){let e,l;return e=new q({props:{size:"12",src:xe,className:"fill-emerald-200"}}),{c(){A(e.$$.fragment)},l(t){U(e.$$.fragment,t)},m(t,n){F(e,t,n),l=!0},i(t){l||($(e.$$.fragment,t),l=!0)},o(t){S(e.$$.fragment,t),l=!1},d(t){W(e,t)}}}function Ce(i){let e,l;return e=new q({props:{size:"12",src:be,className:"fill-emerald-200"}}),{c(){A(e.$$.fragment)},l(t){U(e.$$.fragment,t)},m(t,n){F(e,t,n),l=!0},i(t){l||($(e.$$.fragment,t),l=!0)},o(t){S(e.$$.fragment,t),l=!1},d(t){W(e,t)}}}function ce(i){let e,l,t,n;const a=[$e,Le,Ee],s=[];function u(r,m){return r[14].sender===r[0]?0:r[14].sender==="system"&&r[14].type!=="text"?1:2}return e=u(i),l=s[e]=a[e](i),{c(){l.c(),t=K()},l(r){l.l(r),t=K()},m(r,m){s[e].m(r,m),D(r,t,m),n=!0},p(r,m){let v=e;e=u(r),e===v?s[e].p(r,m):(B(),S(s[v],1,1,()=>{s[v]=null}),N(),l=s[e],l?l.p(r,m):(l=s[e]=a[e](r),l.c()),$(l,1),l.m(t.parentNode,t))},i(r){n||($(l),n=!0)},o(r){S(l),n=!1},d(r){r&&b(t),s[e].d(r)}}}function fe(i){let e,l;return e=new q({props:{size:"23",src:ve,className:"fill-white"}}),{c(){A(e.$$.fragment)},l(t){U(e.$$.fragment,t)},m(t,n){F(e,t,n),l=!0},i(t){l||($(e.$$.fragment,t),l=!0)},o(t){S(e.$$.fragment,t),l=!1},d(t){W(e,t)}}}function ue(i){let e,l;return e=new q({props:{size:"23",src:ke,className:"fill-white animate-spin"}}),{c(){A(e.$$.fragment)},l(t){U(e.$$.fragment,t)},m(t,n){F(e,t,n),l=!0},i(t){l||($(e.$$.fragment,t),l=!0)},o(t){S(e.$$.fragment,t),l=!1},d(t){W(e,t)}}}function Se(i){let e,l,t,n,a,s,u,r,m,v,L,C,p=!i[3]&&se(i),g=i[1]&&i[1].length&&ae(i),o=!i[5]&&fe(),h=i[5]&&ue();return{c(){e=z("div"),l=z("div"),p&&p.c(),t=I(),g&&g.c(),n=I(),a=z("div"),s=z("textarea"),u=I(),r=z("button"),o&&o.c(),m=I(),h&&h.c(),this.h()},l(d){e=E(d,"DIV",{class:!0});var c=M(e);l=E(c,"DIV",{class:!0});var f=M(l);p&&p.l(f),t=V(f),g&&g.l(f),f.forEach(b),n=V(c),a=E(c,"DIV",{class:!0});var x=M(a);s=E(x,"TEXTAREA",{class:!0,name:!0,id:!0,rows:!0,placeholder:!0}),M(s).forEach(b),u=V(x),r=E(x,"BUTTON",{class:!0});var k=M(r);o&&o.l(k),m=V(k),h&&h.l(k),k.forEach(b),x.forEach(b),c.forEach(b),this.h()},h(){w(l,"class","flex flex-col gap-2 min-h-full h-full w-full px-5 pt-5 pb-0 mb-20"),w(s,"class","scrollbar-hide resize-none grow rounded-md border border-zinc-200 p-2 w-full h-full caret-emerald-700 focus:border-emerald-700 focus:outline focus:outline-emerald-700 svelte-1rli4li"),w(s,"name","message"),w(s,"id","message"),w(s,"rows","10"),w(s,"placeholder","Message..."),r.disabled=i[5],w(r,"class","bg-emerald-700 disabled:bg-emerald-600 hover:bg-emerald-600 cursor-pointer text-white h-full py-auto px-3 rounded-md"),w(a,"class","-ml-[2px] w-[700px] p-3 fixed flex flex-row gap-3 items-end bottom-0 h-16 bg-white border-t-[2px] border-x-[2px] border-zinc-100"),w(e,"class","min-h-full h-full relative w-full")},m(d,c){D(d,e,c),_(e,l),p&&p.m(l,null),_(l,t),g&&g.m(l,null),_(e,n),_(e,a),_(a,s),te(s,i[4]),_(a,u),_(a,r),o&&o.m(r,null),_(r,m),h&&h.m(r,null),v=!0,L||(C=[G(s,"input",i[9]),G(r,"click",_e(i[6]))],L=!0)},p(d,[c]){d[3]?p&&(B(),S(p,1,1,()=>{p=null}),N()):p?(p.p(d,c),c&8&&$(p,1)):(p=se(d),p.c(),$(p,1),p.m(l,t)),d[1]&&d[1].length?g?(g.p(d,c),c&2&&$(g,1)):(g=ae(d),g.c(),$(g,1),g.m(l,null)):g&&(B(),S(g,1,1,()=>{g=null}),N()),c&16&&te(s,d[4]),d[5]?o&&(B(),S(o,1,1,()=>{o=null}),N()):o?c&32&&$(o,1):(o=fe(),o.c(),$(o,1),o.m(r,m)),d[5]?h?c&32&&$(h,1):(h=ue(),h.c(),$(h,1),h.m(r,null)):h&&(B(),S(h,1,1,()=>{h=null}),N()),(!v||c&32)&&(r.disabled=d[5])},i(d){v||($(p),$(g),$(o),$(h),v=!0)},o(d){S(p),S(g),S(o),S(h),v=!1},d(d){d&&b(e),p&&p.d(),g&&g.d(),o&&o.d(),h&&h.d(),L=!1,de(C)}}}function Ie(i,e,l){let{username:t=""}=e,n=[],a=0,s={state:R.Load,index:a};const u=new URL(window.location.href);let r=`ws://${window.location.host}/api/room-general`;u.protocol.includes("s")&&(r=`wss://${window.location.host}/api/room-general`);let m=new WebSocket(r),v=navigator.onLine;ge(()=>localStorage.setItem("username",t)),m.onopen=()=>{console.log("Connected to the room chat")},m.onmessage=d=>{const f=JSON.parse(d.data);if(f.sender!==t){const x=f.content.split(/\r\n|\n|\r/gm);f.type==="text"&&(f.content=x),l(1,n=[...n,f]),setTimeout(()=>{document.getElementById(`CH_${a}`).scrollIntoView({behavior:"smooth"}),a+=1},300)}},m.onclose=d=>{l(3,v=!1),console.log("Closed:",d)},m.onerror=d=>{console.log("Error:",d)};let L="",C=!1;function p(){if(!L)return;l(5,C=!0);const d={type:"text",content:L},c=L.split(/\r\n|\n|\r/gm),f={sender:t,type:"text",content:c,datetime:new Date};l(1,n=[...n,f]),l(2,s.state=R.Load,s),setTimeout(()=>{document.getElementById(`CH_${a}`).scrollIntoView({behavior:"smooth"}),a+=1},300);try{l(4,L=""),m.send(JSON.stringify(d)),l(2,s={state:R.Sent,index:a-1}),l(5,C=!1)}catch(x){console.log("ERROR sending message",x),l(2,s={state:R.Error,index:a-1}),l(5,C=!1)}}const g=()=>{l(1,n=[]),a=0,m=new WebSocket(r)},o=()=>window.location.href="/";function h(){L=this.value,l(4,L)}return i.$$set=d=>{"username"in d&&l(0,t=d.username)},navigator.onLine||l(3,v=!1),[t,n,s,v,L,C,p,g,o,h]}class Be extends he{constructor(e){super(),me(this,e,Ie,Se,pe,{username:0})}}export{Be as default};
