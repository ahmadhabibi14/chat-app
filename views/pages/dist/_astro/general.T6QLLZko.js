import{S as q,i as F,s as J,e as g,d as y,c as G,h as b,j as w,l as m,g as I,f as W,m as p,o as V,p as f,D as O,n as X,q as T,L as K,t as Q,u as Y,w as Z,M as ee,z as te,y as z,I as le,B as D,N as $,C as N,O as U,E as P}from"./index.7qfkvOvh.js";import{e as B}from"./each.-oqiv04n.js";import{I as ae}from"./Icon.EjFrvX-M.js";import{t as j}from"./formatter.Zml5IhKd.js";const se={a:{viewBox:"0 0 24 24"},c:`<g><path fill="none" d="M0 0h24v24H0z"></path>
<path d="M3 13h6v-2H3V1.846a.5.5 0 0 1 .741-.438l18.462 10.154a.5.5 0 0 1 0 .876L3.741 22.592A.5.5 0 0 1 3 22.154V13z"></path></g>`};function H(d,l,s){const a=d.slice();return a[8]=l[s],a}function L(d){let l,s=B(d[1]),a=[];for(let e=0;e<s.length;e+=1)a[e]=R(H(d,s,e));return{c(){for(let e=0;e<a.length;e+=1)a[e].c();l=z()},l(e){for(let t=0;t<a.length;t+=1)a[t].l(e);l=z()},m(e,t){for(let n=0;n<a.length;n+=1)a[n]&&a[n].m(e,t);V(e,l,t)},p(e,t){if(t&3){s=B(e[1]);let n;for(n=0;n<s.length;n+=1){const o=H(e,s,n);a[n]?a[n].p(o,t):(a[n]=R(o),a[n].c(),a[n].m(l.parentNode,l))}for(;n<a.length;n+=1)a[n].d(1);a.length=s.length}},d(e){e&&m(l),le(a,e)}}}function ne(d){let l,s,a,e,t=d[8].sender+"",n,o,i,h,_=d[8].content.replace(/\r\n|\n|\r/gm,"<br />")+"",u,r,c=j(d[8].datetime)+"",v,E;return{c(){l=g("div"),s=g("div"),a=g("span"),e=D("@"),n=D(t),o=y(),i=g("p"),h=new $(!1),u=y(),r=g("span"),v=D(c),E=y(),this.h()},l(x){l=b(x,"DIV",{class:!0});var k=w(l);s=b(k,"DIV",{class:!0});var S=w(s);a=b(S,"SPAN",{class:!0});var A=w(a);e=N(A,"@"),n=N(A,t),A.forEach(m),o=I(S),i=b(S,"P",{class:!0});var M=w(i);h=U(M,!1),M.forEach(m),u=I(S),r=b(S,"SPAN",{class:!0});var C=w(r);v=N(C,c),C.forEach(m),S.forEach(m),E=I(k),k.forEach(m),this.h()},h(){p(a,"class","text-[10px] text-sky-600 font-semibold w-fit"),h.a=null,p(i,"class","text-ellipsis break-all"),p(r,"class","text-start text-[10px] font-light text-zinc-700"),p(s,"class","w-fit max-w-[70%] rounded-e-md rounded-tl-md bg-zinc-100 p-2 flex flex-col"),p(l,"class","flex w-full justify-start text-sm")},m(x,k){V(x,l,k),f(l,s),f(s,a),f(a,e),f(a,n),f(s,o),f(s,i),h.m(_,i),f(s,u),f(s,r),f(r,v),f(l,E)},p(x,k){k&2&&t!==(t=x[8].sender+"")&&P(n,t),k&2&&_!==(_=x[8].content.replace(/\r\n|\n|\r/gm,"<br />")+"")&&h.p(_),k&2&&c!==(c=j(x[8].datetime)+"")&&P(v,c)},d(x){x&&m(l)}}}function re(d){let l,s,a,e=d[8].content+"",t,n;return{c(){l=g("div"),s=g("div"),a=g("p"),t=D(e),n=y(),this.h()},l(o){l=b(o,"DIV",{class:!0});var i=w(l);s=b(i,"DIV",{class:!0});var h=w(s);a=b(h,"P",{class:!0});var _=w(a);t=N(_,e),_.forEach(m),h.forEach(m),n=I(i),i.forEach(m),this.h()},h(){p(a,"class","text-ellipsis break-all text-[10px]"),p(s,"class","w-fit max-w-full mx-5 bg-emerald-500/20 text-emerald-700 border border-emerald-700 rounded-full font-semibold py-1 px-3 flex flex-row"),p(l,"class","flex w-full justify-center text-sm")},m(o,i){V(o,l,i),f(l,s),f(s,a),f(a,t),f(l,n)},p(o,i){i&2&&e!==(e=o[8].content+"")&&P(t,e)},d(o){o&&m(l)}}}function oe(d){let l,s,a,e,t=d[8].content.replace(/\r\n|\n|\r/gm,"<br />")+"",n,o,i=j(d[8].datetime)+"",h,_;return{c(){l=g("div"),s=g("div"),a=g("p"),e=new $(!1),n=y(),o=g("span"),h=D(i),_=y(),this.h()},l(u){l=b(u,"DIV",{class:!0});var r=w(l);s=b(r,"DIV",{class:!0});var c=w(s);a=b(c,"P",{class:!0});var v=w(a);e=U(v,!1),v.forEach(m),n=I(c),o=b(c,"SPAN",{class:!0});var E=w(o);h=N(E,i),E.forEach(m),c.forEach(m),_=I(r),r.forEach(m),this.h()},h(){e.a=null,p(a,"class","text-ellipsis break-all"),p(o,"class","text-end text-[10px] font-light text-emerald-100"),p(s,"class","w-fit max-w-[70%] rounded-tr-md rounded-s-md bg-emerald-700 text-white p-2 flex flex-col"),p(l,"class","flex w-full justify-end text-sm")},m(u,r){V(u,l,r),f(l,s),f(s,a),e.m(t,a),f(s,n),f(s,o),f(o,h),f(l,_)},p(u,r){r&2&&t!==(t=u[8].content.replace(/\r\n|\n|\r/gm,"<br />")+"")&&e.p(t),r&2&&i!==(i=j(u[8].datetime)+"")&&P(h,i)},d(u){u&&m(l)}}}function R(d){let l;function s(t,n){return t[8].sender===t[0]?oe:t[8].sender==="system"&&t[8].type!=="text"?re:ne}let a=s(d),e=a(d);return{c(){e.c(),l=z()},l(t){e.l(t),l=z()},m(t,n){e.m(t,n),V(t,l,n)},p(t,n){a===(a=s(t))&&e?e.p(t,n):(e.d(1),e=a(t),e&&(e.c(),e.m(l.parentNode,l)))},d(t){t&&m(l),e.d(t)}}}function ie(d){let l,s,a,e,t,n,o,i,h,_,u,r=d[1]&&d[1].length&&L(d);return i=new ae({props:{size:"23",src:se,className:"fill-white"}}),{c(){l=g("div"),s=g("div"),r&&r.c(),a=y(),e=g("div"),t=g("textarea"),n=y(),o=g("button"),G(i.$$.fragment),this.h()},l(c){l=b(c,"DIV",{class:!0});var v=w(l);s=b(v,"DIV",{class:!0});var E=w(s);r&&r.l(E),E.forEach(m),a=I(v),e=b(v,"DIV",{class:!0});var x=w(e);t=b(x,"TEXTAREA",{class:!0,name:!0,id:!0,rows:!0,placeholder:!0}),w(t).forEach(m),n=I(x),o=b(x,"BUTTON",{class:!0});var k=w(o);W(i.$$.fragment,k),k.forEach(m),x.forEach(m),v.forEach(m),this.h()},h(){p(s,"class","flex flex-col gap-2 min-h-full h-full w-full p-6"),p(t,"class","scrollbar-hide resize-none grow rounded-md border border-zinc-200 p-2 w-full h-full caret-emerald-700 focus:border-emerald-700 focus:outline focus:outline-emerald-700 svelte-1rli4li"),p(t,"name","message"),p(t,"id","message"),p(t,"rows","10"),p(t,"placeholder","Message..."),p(o,"class","bg-emerald-700 hover:bg-emerald-600 cursor-pointer text-white h-full py-auto px-3 rounded-md"),p(e,"class","-ml-[2px] w-[700px] p-3 fixed flex flex-row gap-3 items-end bottom-0 h-16 bg-white border-t-[2px] border-x-[2px] border-zinc-100"),p(l,"class","min-h-full h-full relative w-full")},m(c,v){V(c,l,v),f(l,s),r&&r.m(s,null),f(l,a),f(l,e),f(e,t),O(t,d[2]),f(e,n),f(e,o),X(i,o,null),h=!0,_||(u=[T(t,"input",d[4]),T(o,"click",K(d[3]))],_=!0)},p(c,[v]){c[1]&&c[1].length?r?r.p(c,v):(r=L(c),r.c(),r.m(s,null)):r&&(r.d(1),r=null),v&4&&O(t,c[2])},i(c){h||(Q(i.$$.fragment,c),h=!0)},o(c){Y(i.$$.fragment,c),h=!1},d(c){c&&m(l),r&&r.d(),Z(i),_=!1,ee(u)}}}function ce(d,l,s){let{username:a=""}=l,e=[];const t=new URL(window.location.href);let n=`ws://${window.location.host}/api/room-general`;t.protocol.includes("s")&&(n=`wss://${window.location.host}/api/room-general`);let o=new WebSocket(n);te(()=>{localStorage.setItem("username",a)}),o.onopen=()=>{console.log("Connected to the room chat")},o.onmessage=u=>{const c=JSON.parse(u.data);s(1,e=[...e,c])},o.onclose=u=>{console.log("Closed:",u)};let i="";function h(){const u={type:"text",content:i};try{s(2,i=""),console.log(u),o.send(JSON.stringify(u))}catch(r){console.log(r)}}function _(){i=this.value,s(2,i)}return d.$$set=u=>{"username"in u&&s(0,a=u.username)},[a,e,i,h,_]}class pe extends q{constructor(l){super(),F(this,l,ce,ie,J,{username:0})}}export{pe as default};
